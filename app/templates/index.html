{% extends "base.html" %}

{% block title %}Dashboard - Shark-no-Ninsho-Mon{% endblock %}

{% block extra_css %}
{{ super() }}
<style>
.quick-links {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
    gap: 1rem;
}

.quick-link {
    display: flex;
    align-items: center;
    padding: 0.75rem 1rem;
    border-radius: 12px;
    background: rgba(255, 255, 255, 0.08);
    backdrop-filter: blur(6px);
    border: 1px solid rgba(255, 255, 255, 0.12);
    transition: transform 0.2s ease, border-color 0.2s ease;
}

.quick-link:hover {
    transform: translateY(-2px);
    border-color: rgba(255, 255, 255, 0.3);
}

.link-icon {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    margin-right: 0.75rem;
    padding: 0.5rem;
    border-radius: 10px;
    background: rgba(255, 255, 255, 0.12);
}

.link-icon img {
    width: 28px;
    height: 28px;
    display: block;
}

.quick-link span:last-child {
    font-weight: 600;
}
</style>
{% endblock %}

{% block content %}
<div class="container">
    <!-- Welcome Card -->
    <div class="card welcome-card">
        <h1>Welcome back, <span class="user-email">{{ email }}</span></h1>
        <p class="subtitle">You are successfully authenticated and authorized</p>
    </div>

    <!-- Services Section -->
    <div class="card">
        <div class="card-header">
            <h2>Your Available Services</h2>
            <a href="/admin" class="btn btn-primary">
                Manage Routes
            </a>
        </div>
        
        <div id="services-grid" class="services-grid">
            {% if routes %}
                {% for route in routes %}
                <a href="{{ route.path }}" class="service-card" data-status="{{ route.status }}">
                    <div class="service-icon">
                        <img src="{{ url_for('static', filename='icons/arrow_outward.svg') }}" alt="" aria-hidden="true" style="width: 40px; height: 40px;">
                    </div>
                    <div class="service-info">
                        <h3>{{ route.name }}</h3>
                        <p class="service-path">{{ route.path }}</p>
                        <p class="service-target">{{ route.target_ip }}:{{ route.target_port }}</p>
                    </div>
                    <div class="service-status status-{{ route.status }}">
                        {% if route.status == 'online' %}
                            <span class="status-dot"></span> Online
                        {% elif route.status == 'slow' %}
                            <span class="status-dot"></span> Slow
                        {% elif route.status == 'offline' %}
                            <span class="status-dot"></span> Offline
                        {% else %}
                            <span class="status-dot"></span> Unknown
                        {% endif %}
                    </div>
                </a>
                {% endfor %}
            {% else %}
                <div class="empty-state">
                    <div class="empty-icon">None</div>
                    <h3>No services configured yet</h3>
                    <p>Click "Manage Routes" to add your first service</p>
                    <a href="/admin" class="btn btn-primary">Get Started</a>
                </div>
            {% endif %}
        </div>
    </div>

    <!-- Quick Links -->
    <div class="card">
        <h2>Quick Links</h2>
        <div class="quick-links">
            <a href="/logs" class="quick-link">
                <span class="link-icon">
                    <img src="{{ url_for('static', filename='icons/article.svg') }}" alt="" aria-hidden="true">
                </span>
                <span>Application Logs</span>
            </a>
            <a href="/health" class="quick-link">
                <span class="link-icon">
                    <img src="{{ url_for('static', filename='icons/monitor_heart.svg') }}" alt="" aria-hidden="true">
                </span>
                <span>Health Check</span>
            </a>
        </div>
    </div>
</div>
{% endblock %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shark Route Manager - Setup Wizard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/setup_wizard.css') }}">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Shark Route Manager</h1>
            <p>Setup Wizard - Configure your reverse proxy in minutes</p>
        </div>

        <div class="content">
            <!-- System Checks Section -->
            <div class="section">
                <h2 class="section-title">System Requirements</h2>
                <div id="system-checks-container" class="system-checks">
                    <div class="loading active">
                        <div class="spinner"></div>
                        <p>Checking system requirements...</p>
                    </div>
                </div>
                <div id="warnings-container"></div>
            </div>

            <!-- Configuration Form -->
            <div class="section">
                <h2 class="section-title">Configuration</h2>
                
                <form id="config-form">
                    <!-- OAuth2 Section -->
                    <div class="form-group">
                        <label for="oauth-client-id">Google OAuth2 Client ID *</label>
                        <input 
                            type="text" 
                            id="oauth-client-id" 
                            placeholder="XXXXXX-XXXXX.apps.googleusercontent.com"
                            required
                        >
                        <small>Get your credentials from <a href="https://console.cloud.google.com/apis/credentials" target="_blank">Google Cloud Console</a></small>
                        <div class="error-message" id="oauth-client-id-error"></div>
                    </div>

                    <div class="form-group">
                        <label for="oauth-client-secret">Google OAuth2 Client Secret *</label>
                        <input 
                            type="password" 
                            id="oauth-client-secret" 
                            placeholder="Your OAuth2 Client Secret"
                            required
                        >
                    </div>

                    <div class="form-group">
                        <label for="oauth-cookie-secret">OAuth2 Cookie Secret *</label>
                        <input 
                            type="text" 
                            id="oauth-cookie-secret" 
                            placeholder="Auto-generated secure secret"
                            readonly
                        >
                        <small>Automatically generated - 32 bytes base64 URL-safe</small>
                    </div>

                    <!-- Cookie Refresh Settings -->
                    <div class="form-group">
                        <label for="cookie-expire">Cookie Expiration</label>
                        <select id="cookie-expire">
                            <option value="24h">24 hours</option>
                            <option value="168h" selected>7 days (recommended)</option>
                            <option value="336h">14 days</option>
                            <option value="720h">30 days</option>
                        </select>
                        <small>How long before users must re-authenticate</small>
                    </div>

                    <div class="form-group">
                        <label for="cookie-refresh">Cookie Refresh Interval</label>
                        <select id="cookie-refresh">
                            <option value="0" selected>Disabled (no automatic refresh)</option>
                            <option value="1h">Every hour (high security)</option>
                            <option value="24h">Daily (balanced)</option>
                            <option value="168h">Weekly (recommended)</option>
                            <option value="720h">Monthly (30 days)</option>
                        </select>
                        <small>How often to refresh authentication token (0 = disabled)</small>
                    </div>

                    <!-- Tailscale Section -->
                    <div class="form-group">
                        <label for="tailscale-hostname">Tailscale Funnel Hostname *</label>
                        <input 
                            type="text" 
                            id="tailscale-hostname" 
                            placeholder="sharky.snowy-burbot.ts.net"
                            required
                        >
                        <small>Your full Tailscale Funnel domain (format: hostname.tailnet.ts.net)</small>
                        <div class="error-message" id="tailscale-hostname-error"></div>
                    </div>

                    <!-- Authorized Email Section -->
                    <div class="form-group">
                        <label for="authorized-email">Authorized Email Address *</label>
                        <input 
                            type="email" 
                            id="authorized-email" 
                            placeholder="your-email@gmail.com"
                            required
                        >
                        <small>The Google account email that will be allowed to access the dashboard</small>
                        <div class="error-message" id="authorized-email-error"></div>
                    </div>

                    <!-- Flask App Section -->
                    <div class="form-group">
                        <label for="flask-secret-key">Flask Secret Key *</label>
                        <input 
                            type="text" 
                            id="flask-secret-key" 
                            placeholder="Auto-generated secure secret"
                            readonly
                        >
                        <small>Automatically generated - 64 hex characters</small>
                    </div>

                    <div class="form-group">
                        <label for="flask-session-lifetime">Flask Session Lifetime</label>
                        <select id="flask-session-lifetime">
                            <option value="3600">1 hour</option>
                            <option value="86400">1 day</option>
                            <option value="604800" selected>7 days (recommended)</option>
                            <option value="2592000">30 days</option>
                        </select>
                        <small>How long Flask dashboard sessions remain active</small>
                    </div>

                    <div class="checkbox-group">
                        <input type="checkbox" id="dev-mode">
                        <label for="dev-mode">
                            <strong>Enable Development Mode</strong>
                            <small style="display: block; font-weight: normal; color: #666;">
                                Bypass OAuth2 authentication for local testing (NOT for production!)
                            </small>
                        </label>
                    </div>

                    <!-- Buttons -->
                    <div class="button-group">
                        <button type="button" class="btn btn-secondary" id="generate-secrets-btn">
                            Generate Secrets
                        </button>
                        <button type="button" class="btn btn-secondary" id="load-config-btn">
                            Load Existing Config
                        </button>
                        <button type="submit" class="btn btn-primary" id="save-config-btn">
                            Save Configuration
                        </button>
                    </div>
                </form>

                <div id="save-result" class="hidden"></div>
            </div>

            <!-- Docker Controls -->
            <div class="section">
                <h2 class="section-title">Docker Controls</h2>
                <p style="margin-bottom: 20px; color: #666;">
                    Start or stop the Docker containers after configuration is complete.
                </p>
                <div class="button-group">
                    <button type="button" class="btn btn-success" id="docker-start-btn">
                        Start Docker Containers
                    </button>
                    <button type="button" class="btn btn-secondary" id="docker-stop-btn">
                        Stop Docker Containers
                    </button>
                </div>
                <div id="docker-result" class="hidden"></div>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/setup_wizard.js') }}"></script>
</body>
</html>
